---
title: "Pr√°ctica de la **Unidad 5. Visualizaci√≥n de datos s en R**"
subtitle: "Del Curso introductorio al lenguaje de programaci√≥n R orientado al an√°lisis cuantitativo en Ciencias Sociales"
author: "Por Sarah√≠ Aguilar"
output:
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

[üè†‚Ü© De vuelta a la p√°gina principal del curso](index.html)

<br/>

## Inicio

> #### **üöÄ Objetivo de la unidad** 
Que el estudiante conozca los distintos tipos de visualizaci√≥n en R y reconozca sus casos de uso.  

<br/>

**Nota importante:** Los siguientes m√≥dulos pr√°cticos son lineales. 

<br/>

## 5.1. Instalando y cargando paquetes y conjuntos de datos
```{r}
# install.packages("ggplot2")
library(ggplot2)
library(data.table)
```

<br/> 

Para la presente pr√°ctica utilizaremos los siguientes conjuntos de datos: 
```{r}
# Datos de 38 modelos de autom√≥viles generadp por la US Environmental Protection Agency 
mpg <- data.table(ggplot2::mpg)
# Datos mensuales de indicadores econ√≥micos de Estados Unidos por el Fereal Reserva Bank of St. Louis
eco <- data.table(ggplot2::economics)

mov <- data.table(ggplot2movies::movies)
```

<br/> 

## 5.2 Con una sola variable

* **Continua**

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(hwy)) +
  geom_area(stat = "bin")
```

<br/> 

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(hwy)) +
  geom_density(kernel = "gaussian")
```

<br/> 

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(hwy)) +
  geom_dotplot()
```

<br/> 

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(hwy)) +
  geom_freqpoly()
```

<br/>

* **Discreta**

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(hwy)) +
  geom_histogram(binwidth = 5)
```
<br/>

```{r}
ggplot(mpg, aes(fl, fill = drv)) +
  geom_bar(position = "dodge") # fill, stack, jitter
```

<br/>

## Ejercicio #1
1. ¬øEn qu√© casos utilizar√≠a ```geom_dotplot()``` sobre ```geom_density()```? 
2. ¬øEn qu√© casos utilizar√≠a ```geom_histogram()``` sobre ```geom_dotplot()```? 
3. Cree una visualizaci√≥n para la variable displ del conjunto de datos mpg e identifique la moda artim√©tica. 
4. Utilizando el comando de ayuda (```?<nombre de la funci√≥n>```), identifique qu√© aesthetics se pueden modificar en un geom_histogram.

<br/>

## 5.3 Con dos variables

* **Dos variables continuas**

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = cty, y = hwy)) +
  geom_point()
```

<br/>

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = cty, y = hwy)) +
  geom_jitter()
```

<br/>

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = cty, y = hwy)) +
  geom_rug(sides = "bl")
```

<br/>

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = cty, y = hwy)) +
  geom_smooth(model = lm)
```

<br/>

* Una variable discreta y una variable continua continua

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = as.factor(cty), y = hwy)) +
  geom_bar(stat = "identity")
```


</br>

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = as.factor(cty), y = hwy)) +
  geom_boxplot()
```

</br>

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = as.factor(cty), y = hwy)) +
  geom_dotplot(binaxis = "y", stackdir = "center")
```

</br>

```{r message=FALSE, warning=FALSE}
ggplot(mpg, aes(x = as.factor(cty), y = hwy)) +
  geom_violin(scale = "area")
```

<br/>

## Ejercicio #2
1. Describa la relaci√≥n entre las variables cty y hwy en el conjunto de datos mpg. 
2. Describa dos conclusiones a las que puede llegar con un box plot sobre las variables cty y hwy.
3. Seleccione otra variable variable discreta y otra variable continua cotinua diferentes a las ya utilizadas y grafique su relaci√≥n. Justifique la selecci√≥n de su visualizaci√≥n y describa dos conclusiones a las que lleg√≥. 

<br/>

* **Distribuci√≥n bivariada cont√≠nua**

```{r}
ggplot(mov, aes(year, rating)) +
  geom_bin2d(binwidth = c(5, 0.5))
```

<br/>

```{r}
ggplot(mov, aes(year, rating)) +
  geom_density2d()
```

<br/>

* **Funci√≥n continua**

```{r}
ggplot(eco, aes(date, unemploy)) +
  geom_area()
```

<br/>

```{r}
ggplot(eco, aes(date, unemploy)) +
  geom_line()
```

<br/>

```{r}
ggplot(eco, aes(date, unemploy)) +
  geom_step(direction = "hv")
```

<br/>

* **Visualizando el error**

```{r}
dt <- data.table(grp = c("A", "B"), fit = 4:5, se = 1:2)
```

<br/>

```{r}
ggplot(dt, aes(grp, fit, ymin = fit-se, ymax = fit+se)) +
  geom_crossbar(fatten = 2)
```

<br/>

```{r}
ggplot(dt, aes(grp, fit, ymin = fit-se, ymax = fit+se)) +
  geom_errorbar()
```

<br/>

```{r}
ggplot(dt, aes(grp, fit, ymin = fit-se, ymax = fit+se)) +
  geom_linerange()
```

<br/>

```{r}
ggplot(dt, aes(grp, fit, ymin = fit-se, ymax = fit+se)) +
  geom_pointrange()
```

</br>

## Ejercicio #3

1. Cree un nuevo data.table ejemplo con tres columnas: la primera que contenga 5 letras, la segunda que contenga un n√∫mero aleatorio entre 5 y 15, y la tercera que contenga un n√∫mero aleatorio entre 0 y 4. La primera columna corresponde al nombre de una categor√≠a, la segunda columna corresponde al valor promedio de dicha categor√≠a en una variable aleatoria y la tercera columna corresponde al valor de la desviaci√≥n est√°ndar de dicha categor√≠a en una variable aleatoria.
2. Construya una visualizaci√≥n en la que se pueda estudiar c√≥mo var√≠a la media y la desviaci√≥n est√°ndar de cada categor√≠a.
3. Grafique la evoluci√≥n del desempleo en Estados Unidos utilizando puntos y una l√≠nea. 

</br>

</br>

## 5.4 Formateando

```{r}
# install.packages("viridis")
library(viridis)
```

```{r}
dt <- fread("./data/gdpPercap_nacional.csv")

ggplot(dt, aes(x=gdpPercap, y=lifeExp, size=pop, fill=continent)) +
    geom_point(alpha=0.5, shape=21, color="black") +
    scale_size(range = c(.1, 24), name="Population (M)") +
    theme_light() +
    theme(legend.position="bottom") +
    ylab("Life Expectancy") +
    xlab("Gdp per Capita") +
    labs(title = "Title") +
    theme(legend.position = "none")
```

</br>

## üèÑ Ejercicio #4
1. Con la base de datos tabuladas del censo de poblaci√≥n 2020, grafique tres diagrmas de dispersi√≥n:
- Uno con dos variables num√©ricas. 
- Uno con una variable num√©rica y dos variables categ√≥ricas.
- Uno con dos variables num√©ricas y una categ√≥rica. 