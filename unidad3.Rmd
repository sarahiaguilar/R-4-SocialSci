---
title: "Pr√°ctica de la **Unidad 3. Procesamiento de datos**"
subtitle: "Del Curso introductorio al lenguaje de programaci√≥n R orientado al an√°lisis cuantitativo en Ciencias Sociales"
author: "Por Sarah√≠ Aguilar"
output:
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

[üè†‚Ü© De vuelta a la p√°gina principal del curso](index.html)

<br/>

## Inicio

> #### **üöÄ Objetivo de la unidad** 
Que el estudiante sea capaz de importar y exportar conjuntos de datos de y en diferentes formatos, as√≠ como ejecutar transformaciones b√°sicas sobre estas utilizando dataframes y el paquete `data.table`.

<br/>

## 2.1. Instalando y cargando paquetes

Instalando un paquete
Esta instrucci√≥n descarga el paquete a tu equipo de c√≥mputo. Por lo tanto, solo se debe correr una √∫nica vez.
```{r}
# install.packages("data.table")
# install.packages("ggplot2")
# install.packages("curl")
# install.packages("xlsx")
# install.packages("foreign")
```

</br>
Cargando un paquete
Esta instrucci√≥n carga las funciones del paquete a tu sesi√≥n. Por lo tanto, debemos correrla cada que vayamos a utilizar las funciones del paquete.
```{r}
library(data.table)
library(ggplot2)
```

## 2.2. Creando un data table

* Desde 0

Recuerde que un data frame (y por lo tanto, un data table tambi√©n) se compone de vectores. En el siguiente bloque de c√≥digo, se instancian dos vectores inicialmente para despu√©s utilizarlos al crear un nuevo data table desde 0.
üí° Recordemos que los data tables heredan todas las propiedades de un data frame. 
```{r}
x <- 1:200
y <- rnorm(200, mean=70, sd=10)
dt <- data.table(id=x, 
                 age=y) 
```
Es importante denotar que los vectores que conformaran las columnas de un data table al crearlo desde 0, deben ser del mismo tama√±o.  
<br/>

* A partir de un data frame

Utilizamos la misma funci√≥n que empleamos para instanciar un data table desde 0.
```{r}
x <- 1:200
y <- rnorm(200, mean=70, sd=10)
df <- data.frame(id=x, 
                 age=y) 
dt <- data.table(df)
```
<br/>

* A partir de un archivo con formato tabular

Utilizamos la funci√≥n ```fread()```, que lee y convierte el contenido del archivo en un data table.  
üí° El formato *ideal* para leer y escribir datos en un entorno de desarrollo orientado al an√°lisis de conjuntos de datos (como R) es el csv ("valores separados por comas" por sus siglas en ingl√©s).
```{r}
dt_dem_nyc <- fread("./data/ENOEN_COE1T122.csv")
```
üí° Note que la ruta para leer el archivo comienza en el directorio de trabajo de RStudio y que termina con el nombre completo (incluyendo sufijo) del archivo.

</br>
Tambi√©n es posible utilizar hiperv√≠nculos como ruta de lectura de un archivo. 
```{r}
dt_diab <- fread("https://raw.githubusercontent.com/sarahiaguilar/fundamentos-cdd/main/datos/diabetes.csv")
```
</br>
La funci√≥n fread tiene par√°metros que facilita la lectura de archivos con formatos m√°s complejos. 
üí° Recuerde que para conocer m√°s acerca de una funci√≥n espec√≠fica (incluyendo sus par√°metros y valores por defecto), corra "?" + el nombre de la funci√≥n. 

Por ejemplo, si el archivo no contiene un encabezado (nombres de columnas), podemos utilizar el par√°metro `header` para indicarlo.
```{r}
dt_txt <- fread("./data/plain_txt.txt", header=FALSE)
```

</br>
O si el archivo est√° separado por un caracter distinto a unaa coma, podemos utilizar el par√°metro `sep` para indicarlo.
```{r}
dt_delim <- fread("./data/txt_with_delim.txt", sep="$")
```

</br>
Para archivos xlsx utilizamos la funci√≥n `read_xlsx` del paquete `readxl`. 
```{r}
library(readxl)
dt_xlsx <- read_xlsx("./data/hoja_de_calculo.xlsx", sheet=1)
```

</br>
Para archivos .sav (SPSS) o .dta (STATA) utilizamos el paquete `foreign`. 
```{r}
library(foreign)
# df_spss <- read.spss("example.sav",
#                      to.data.frame=TRUE,
#                      use.value.labels=FALSE)
# df_stata <- read.dta("example.dta")
```
